"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5075],{5075:(R,p,s)=>{s.r(p),s.d(p,{HomePageModule:()=>F});var m=s(8434),a=s(3092),d=s(4341),u=s(9262),h=s(467),f=s(4690),_=s(5312),e=s(1360),C=s(7544),P=s(6765),v=s(8093),x=s(5495),M=s(9815);function k(o,c){if(1&o){const i=e.RV6();e.j41(0,"div",13)(1,"ion-searchbar",14),e.mxI("ngModelChange",function(n){e.eBV(i);const r=e.XpG();return e.DH7(r.searchText,n)||(r.searchText=n),e.Njj(n)}),e.k0s()()}if(2&o){const i=e.XpG();e.R7$(),e.R50("ngModel",i.searchText)}}function b(o,c){if(1&o&&(e.j41(0,"div",29)(1,"strong"),e.EFF(2),e.k0s(),e.EFF(3),e.k0s()),2&o){const i=c.$implicit;e.R7$(2),e.SpI("",i.username||"User",":"),e.R7$(),e.SpI(" ",i.content," ")}}function O(o,c){if(1&o){const i=e.RV6();e.j41(0,"div",25),e.DNE(1,b,4,2,"div",26),e.j41(2,"ion-item")(3,"ion-input",27),e.mxI("ngModelChange",function(n){e.eBV(i);const r=e.XpG().$implicit;return e.DH7(r.newComment,n)||(r.newComment=n),e.Njj(n)}),e.k0s(),e.j41(4,"ion-button",28),e.bIt("click",function(){e.eBV(i);const n=e.XpG().$implicit,r=e.XpG();return e.Njj(r.addComment(n))}),e.EFF(5,"Post"),e.k0s()()()}if(2&o){const i=e.XpG().$implicit;e.R7$(),e.Y8G("ngForOf",i.comments),e.R7$(2),e.R50("ngModel",i.newComment)}}function I(o,c){if(1&o){const i=e.RV6();e.j41(0,"ion-card",15)(1,"div",16),e.nrm(2,"img",17),e.j41(3,"div",18),e.bIt("click",function(){const n=e.eBV(i).$implicit,r=e.XpG();return e.Njj(r.navigateToUserProfile(n.userId))}),e.j41(4,"h3"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7),e.nI1(8,"date"),e.k0s()()(),e.nrm(9,"img",19),e.j41(10,"div",20)(11,"p"),e.EFF(12),e.k0s(),e.j41(13,"ion-icon",21),e.bIt("click",function(){const n=e.eBV(i).$implicit,r=e.XpG();return e.Njj(r.toggleLike(n))}),e.k0s(),e.j41(14,"span",22),e.EFF(15),e.k0s(),e.j41(16,"ion-icon",23),e.bIt("click",function(){const n=e.eBV(i).$implicit,r=e.XpG();return e.Njj(r.toggleComments(n))}),e.k0s()(),e.DNE(17,O,6,2,"div",24),e.k0s()}if(2&o){const i=c.$implicit,t=e.XpG();e.R7$(2),e.Y8G("src",i.profileImage?"http://localhost:8080/api/users/profile-image/"+i.profileImage:"assets/profile-pic-image.jpg",e.B4B),e.R7$(3),e.JRh(i.username),e.R7$(2),e.JRh(e.i5U(8,8,i.createdAt,"short")),e.R7$(2),e.Y8G("src",t.environment.apiBaseUrl.replace("/api","")+i.imageUrl,e.B4B),e.R7$(3),e.JRh(i.content),e.R7$(),e.Y8G("name",i.likedByCurrentUser?"heart":"heart-outline"),e.R7$(2),e.SpI("",i.likesCount||0," Likes"),e.R7$(2),e.Y8G("ngIf",i.showComments)}}function j(o,c){1&o&&(e.j41(0,"div",30)(1,"p",31),e.EFF(2,"No matching posts found!"),e.k0s()())}const y=[{path:"",component:(()=>{var o;class c{constructor(t,n,r,g,l,H){this.router=t,this.modalController=n,this.userService=r,this.postService=g,this.commentService=l,this.profileImageService=H,this.environment=_.c,this.showSearchBar=!1,this.searchText="",this.posts=[],this.showComments=!1}toggleSearchBar(){this.showSearchBar=!this.showSearchBar}ngOnInit(){const t=localStorage.getItem("userEmail");t&&this.userService.getUserByEmail(t).subscribe({next:n=>{this.userDetails=n,console.log("Logged-in user details:",this.userDetails)},error:n=>{console.error("Failed to fetch user:",n)}}),this.loadPosts()}loadPosts(){this.postService.getAllPosts().subscribe({next:t=>{this.posts=t,this.posts.forEach(n=>{this.userService.getUserById(n.userId).subscribe({next:r=>{n.username=r.username,n.profileImage=r.profileImage},error:()=>{n.username="Unknown",n.profileImage=null}}),this.postService.getLikes(n.id).subscribe({next:r=>n.likesCount=r,error:()=>n.likesCount=0}),this.postService.isPostLikedByUser(n.id,this.userDetails.id).subscribe({next:r=>n.likedByCurrentUser=r,error:()=>n.likedByCurrentUser=!1})})},error:t=>{console.error("Error fetching posts:",t)}})}navigate(t){this.router.navigate([t])}openMenuModal(){var t=this;return(0,h.A)(function*(){yield(yield t.modalController.create({component:f.y})).present()})()}toggleLike(t){var n;null!==(n=this.userDetails)&&void 0!==n&&n.id&&(t.likedByCurrentUser?this.postService.unlikePost(t.id,this.userDetails.id).subscribe({next:()=>{t.likedByCurrentUser=!1,t.likesCount=(t.likesCount||1)-1},error:r=>console.error("Failed to unlike post",r)}):this.postService.likePost(t.id,this.userDetails.id).subscribe({next:()=>{t.likedByCurrentUser=!0,t.likesCount=(t.likesCount||0)+1},error:r=>console.error("Failed to like post",r)}))}toggleComments(t){t.showComments=!t.showComments,t.showComments&&!t.comments&&this.commentService.getCommentsByPostId(t.id).subscribe({next:n=>{t.comments=n},error:n=>{console.error(`Failed to fetch comments for post ${t.id}:`,n),t.comments=[]}})}addComment(t){var n;const r=null===(n=t.newComment)||void 0===n?void 0:n.trim();r&&this.commentService.addComment({postId:t.id,userId:this.userDetails.id,content:r}).subscribe({next:l=>{l.username=this.userDetails.username,t.comments=t.comments||[],t.comments.push(l),t.newComment=""},error:l=>{console.error("Error posting comment:",l)}})}filteredPosts(){if(!this.searchText.trim())return this.posts;const t=this.searchText.toLowerCase();return this.posts.filter(n=>n.username&&n.username.toLowerCase().includes(t)||n.content&&n.content.toLowerCase().includes(t))}navigateToUserProfile(t){this.userService.getUserById(t).subscribe({next:n=>{"barber"===n.role?this.router.navigate(["/view-barber-profile",t],{queryParams:{userId:n.id}}):"client"===n.role?this.router.navigate(["/view-client-profile"],{queryParams:{userId:n.id}}):console.warn("Unsupported user role:",n.role)},error:n=>{console.error("Failed to fetch user for profile navigation:",n)}})}}return(o=c).\u0275fac=function(t){return new(t||o)(e.rXU(C.Ix),e.rXU(a.W3),e.rXU(P.h),e.rXU(v.K),e.rXU(x.j),e.rXU(M.K))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-home"]],standalone:!1,decls:16,vars:3,consts:[[1,"feed-page"],[1,"heading-title",2,"padding","15px","display","flex","justify-content","space-between"],[2,"display","flex","gap","10px"],[2,"font-size","25px","cursor","pointer","position","relative","top","25px",3,"click"],["name","menu-outline"],[1,"options",2,"display","flex","gap","10px","position","relative","top","27px"],["name","search-outline",2,"font-size","24px",3,"click"],["name","notifications-outline",2,"font-size","24px",3,"click"],["name","person-outline",2,"font-size","24px",3,"click"],["class","search-container",4,"ngIf"],[1,"feed-wrapper"],["class","post-card",4,"ngFor","ngForOf"],["style","text-align:center; padding:20px;",4,"ngIf"],[1,"search-container"],["placeholder","Search...",3,"ngModelChange","ngModel"],[1,"post-card"],[1,"post-header"],[1,"avatar",3,"src"],[1,"info",3,"click"],[1,"post-image",3,"src"],[1,"post-body"],["color","danger",3,"click","name"],[1,"likes-count",2,"position","relative","bottom","8px","right","7px"],["name","chatbubble-outline",3,"click"],["class","comments-section",4,"ngIf"],[1,"comments-section"],["class","comment",4,"ngFor","ngForOf"],["placeholder","Add a comment...",3,"ngModelChange","ngModel"],["fill","clear",3,"click"],[1,"comment"],[2,"text-align","center","padding","20px"],[2,"color","grey","font-style","italic"]],template:function(t,n){1&t&&(e.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3),e.bIt("click",function(){return n.openMenuModal()}),e.nrm(4,"ion-icon",4),e.k0s(),e.j41(5,"div")(6,"h1"),e.EFF(7,"iBarber"),e.k0s()()(),e.j41(8,"div",5)(9,"ion-icon",6),e.bIt("click",function(){return n.toggleSearchBar()}),e.k0s(),e.j41(10,"ion-icon",7),e.bIt("click",function(){return n.navigate("/chat-list")}),e.k0s(),e.j41(11,"ion-icon",8),e.bIt("click",function(){return n.navigate("/profile")}),e.k0s()()(),e.DNE(12,k,2,1,"div",9),e.j41(13,"div",10),e.DNE(14,I,18,11,"ion-card",11),e.k0s(),e.DNE(15,j,3,0,"div",12),e.k0s()),2&t&&(e.R7$(12),e.Y8G("ngIf",n.showSearchBar),e.R7$(2),e.Y8G("ngForOf",n.filteredPosts()),e.R7$(),e.Y8G("ngIf",0===n.filteredPosts().length))},dependencies:[m.Sq,m.bT,d.BC,d.vS,a.Jm,a.b_,a.W9,a.iq,a.$w,a.uz,a.S1,a.Gw,m.vh],styles:[".feed-page[_ngcontent-%COMP%]{--background: #f4f4f4}.feed-page[_ngcontent-%COMP%]   .feed-wrapper[_ngcontent-%COMP%]{padding:10px}.feed-page[_ngcontent-%COMP%]   .post-card[_ngcontent-%COMP%]{border-radius:15px;box-shadow:none;margin-bottom:20px}.feed-page[_ngcontent-%COMP%]   .post-card[_ngcontent-%COMP%]   .post-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px}.feed-page[_ngcontent-%COMP%]   .post-card[_ngcontent-%COMP%]   .post-header[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;margin-right:10px}.feed-page[_ngcontent-%COMP%]   .post-card[_ngcontent-%COMP%]   .post-header[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px}.feed-page[_ngcontent-%COMP%]   .post-card[_ngcontent-%COMP%]   .post-header[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:12px;color:gray}.feed-page[_ngcontent-%COMP%]   .post-card[_ngcontent-%COMP%]   .post-image[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:10px}.feed-page[_ngcontent-%COMP%]   .post-card[_ngcontent-%COMP%]   .post-body[_ngcontent-%COMP%]{padding:10px}.feed-page[_ngcontent-%COMP%]   .post-card[_ngcontent-%COMP%]   .post-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:10px}.feed-page[_ngcontent-%COMP%]   .post-card[_ngcontent-%COMP%]   .post-body[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px;margin-right:15px;color:#222}ion-searchbar[_ngcontent-%COMP%]{--background: #fff;border-radius:12px;margin-bottom:16px}.search-container[_ngcontent-%COMP%]{margin-top:10px;padding:0 16px}.comments-section[_ngcontent-%COMP%]{padding:10px;border-top:1px solid #ccc}.comment[_ngcontent-%COMP%]{font-size:14px;margin-bottom:5px}ion-searchbar[_ngcontent-%COMP%]{--border-radius: 12px}.likes-count[_ngcontent-%COMP%]{margin-right:3px;font-weight:700}"]}),c})()}];let B=(()=>{var o;class c{}return(o=c).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[u.iI.forChild(y),u.iI]}),c})(),F=(()=>{var o;class c{}return(o=c).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[m.MD,d.YN,a.bv,B]}),c})()}}]);